# REQ-148: æ€§æ ¼æ¤œæŸ»æ‹¡å¼µ - è¡Œå‹•ç‰¹æ€§ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ãƒ»EQãƒ»ä¾¡å€¤è¦³è¨ºæ–­

**Issue**: #148
**ä½œæˆæ—¥**: 2025-12-30
**ä½œæˆè€…**: @claude-code
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Draft

---

## Phase 2: è¦ä»¶å®šç¾©ãƒ»ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

### 2.1 æ©Ÿèƒ½æ¦‚è¦

**ç›®çš„ï¼ˆWhyï¼‰**:
Big5æ€§æ ¼æ¤œæŸ»ã®ã¿ã§ã¯æ¡ç”¨åˆ¤æ–­ã®ææ–™ã¨ã—ã¦ä¸ååˆ†ã§ã‚ã‚Šã€ç«¶åˆã‚µãƒ¼ãƒ“ã‚¹ï¼ˆSPIã€CUBICã€ãƒŸã‚­ãƒ¯ãƒ¡ç­‰ï¼‰ã¨ã®å·®åˆ¥åŒ–ãŒå›°é›£ã€‚å¤šé¢çš„ãªæ€§æ ¼æ¤œæŸ»ã‚’å®Ÿè£…ã—ã€æ¡ç”¨ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚

**å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆWhoï¼‰**:
- æ¡ç”¨æ‹…å½“è€…
- äººäº‹éƒ¨é–€
- å€™è£œè€…ï¼ˆæ¤œæŸ»å—é¨“è€…ï¼‰

**é”æˆã—ãŸã„ä¾¡å€¤ï¼ˆWhatï¼‰**:
- ã‚ˆã‚Šå¤šé¢çš„ãªäººç‰©ç†è§£
- æ¡ç”¨ç²¾åº¦ã®å‘ä¸Š
- ç«¶åˆã‚µãƒ¼ãƒ“ã‚¹ã¨ã®æ©Ÿèƒ½ãƒ‘ãƒªãƒ†ã‚£é”æˆ

---

### 2.2 ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®šç¾©ï¼ˆRole Ã— Outcomeï¼‰

#### UC-IDä½“ç³»

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å€¤ | èª¬æ˜ |
|-----------|-----|------|
| DOMAIN | ASSESS | é©æ€§æ¤œæŸ»ãƒ‰ãƒ¡ã‚¤ãƒ³ |
| ROLE | ADMIN / CANDIDATE | ç®¡ç†è€… / å€™è£œè€… |
| OUTCOME | CONDUCT / VIEW / ANALYZE | å®Ÿæ–½ / é–²è¦§ / åˆ†æ |
| CHANNEL | WEB | Webãƒãƒ£ãƒãƒ« |

#### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ä¸€è¦§

| UC-ID | Role | Outcome | èª¬æ˜ |
|-------|------|---------|------|
| UC-ASSESS-CAND-CONDUCT-WEB | Candidate | æ¤œæŸ»å®Ÿæ–½ | å€™è£œè€…ãŒè¡Œå‹•ç‰¹æ€§ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ãƒ»EQãƒ»ä¾¡å€¤è¦³æ¤œæŸ»ã‚’å®Ÿæ–½ã™ã‚‹ |
| UC-ASSESS-ADMIN-VIEW-WEB | Admin | çµæœé–²è¦§ | ç®¡ç†è€…ãŒå€™è£œè€…ã®æ‹¡å¼µæ¤œæŸ»çµæœã‚’é–²è¦§ã™ã‚‹ |
| UC-ASSESS-ADMIN-ANALYZE-WEB | Admin | æ¯”è¼ƒåˆ†æ | ç®¡ç†è€…ãŒè¤‡æ•°å€™è£œè€…ã®æ¤œæŸ»çµæœã‚’æ¯”è¼ƒåˆ†æã™ã‚‹ |
| UC-ASSESS-ADMIN-EXPORT-WEB | Admin | CSVå‡ºåŠ› | ç®¡ç†è€…ãŒæ‹¡å¼µæ¤œæŸ»çµæœã‚’å«ã‚€CSVã‚’å‡ºåŠ›ã™ã‚‹ |

---

### 2.3 ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆMECEè¨¼æ˜ï¼‰

| Role \ Outcome | æ¤œæŸ»å®Ÿæ–½ | çµæœé–²è¦§ | æ¯”è¼ƒåˆ†æ | CSVå‡ºåŠ› |
|----------------|----------|----------|----------|---------|
| Admin          | â€”        | âœ…       | ğŸŸ¡       | ğŸŸ¡      |
| Candidate      | âœ…       | â€”        | â€”        | â€”       |

**å‡¡ä¾‹**:
- âœ… Gold E2Eå¯¾è±¡
- ğŸŸ¡ Bronze/Silverå¯¾è±¡ï¼ˆGoldå¯¾è±¡å¤–ï¼‰
- â€” è©²å½“ãªã—

**è©²å½“ãªã—ã®ç†ç”±**:
- Admin â†’ æ¤œæŸ»å®Ÿæ–½: ç®¡ç†è€…ã¯æ¤œæŸ»ã‚’å—é¨“ã—ãªã„
- Candidate â†’ çµæœé–²è¦§/æ¯”è¼ƒåˆ†æ/CSVå‡ºåŠ›: å€™è£œè€…ã¯è‡ªåˆ†ã®çµæœã‚’è¦‹ã‚‰ã‚Œãªã„ï¼ˆå°†æ¥æ©Ÿèƒ½ï¼‰

---

### 2.4 ä¾¡å€¤ãƒ•ãƒ­ãƒ¼ãƒãƒƒãƒ—

```mermaid
graph LR
    subgraph Input
        A[å€™è£œè€…: æ¤œæŸ»ãƒªãƒ³ã‚¯ã‚¢ã‚¯ã‚»ã‚¹]
        B[ç®¡ç†è€…: çµæœé–²è¦§ãƒªã‚¯ã‚¨ã‚¹ãƒˆ]
    end

    subgraph Process
        C[è³ªå•è¡¨ç¤º]
        D[å›ç­”åé›†]
        E[ã‚¹ã‚³ã‚¢ç®—å‡º]
        F[ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ]
    end

    subgraph Output
        G[å®Œäº†ç”»é¢]
        H[æ‹¡å¼µçµæœãƒ¬ãƒãƒ¼ãƒˆ]
        I[CSVå‡ºåŠ›]
    end

    A --> C --> D --> E --> G
    B --> F --> H
    B --> I
```

---

## Phase 3: å“è³ªåŸºæº–

### 3.1 DoD Level

**é¸æŠã—ãŸ DoD Level**: [x] Silver

| Level | è¦³ç‚¹æ•° | ã‚«ãƒãƒ¬ãƒƒã‚¸ | ç”¨é€” |
|-------|--------|-----------|------|
| Bronze | 27 | 80% | ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒ»ç·Šæ€¥ä¿®æ­£ |
| **Silver** | **31** | **85%** | **æ¨å¥¨ï¼ˆé€šå¸¸é–‹ç™ºï¼‰** â† é¸æŠ |
| Gold | 19 | 95% | æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹ãƒ»é‡è¦æ©Ÿèƒ½ |

**é¸æŠç†ç”±**:
- æ–°è¦æ©Ÿèƒ½è¿½åŠ ã ãŒã€æ—¢å­˜ã®æ¤œæŸ»ãƒ•ãƒ­ãƒ¼ã‚’æ‹¡å¼µã™ã‚‹å½¢
- 4ã¤ã®æ¤œæŸ»ã‚’æ®µéšçš„ã«å®Ÿè£…ã™ã‚‹ãŸã‚ã€å„ãƒ•ã‚§ãƒ¼ã‚ºã§Silverå“è³ªã‚’æ‹…ä¿
- å…¨ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã«Goldæ˜‡æ ¼ã‚’æ¤œè¨

---

### 3.2 Pre-mortemï¼ˆå¤±æ•—ã‚·ãƒŠãƒªã‚ªï¼‰

| # | å¤±æ•—ã‚·ãƒŠãƒªã‚ª | ç™ºç”Ÿç¢ºç‡ | å¯¾ç­– |
|---|------------|---------|------|
| 1 | è³ªå•æ•°ãŒå¤šã™ãã¦å€™è£œè€…ãŒé›¢è„± | High | å„æ¤œæŸ»15-25å•ã«åˆ¶é™ã€é€²æ—ãƒãƒ¼è¡¨ç¤ºã€ä¸­æ–­ãƒ»å†é–‹æ©Ÿèƒ½ |
| 2 | ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ã®ä¿¡é ¼æ€§ä¸è¶³ | Med | å¿ƒç†å­¦çš„æ ¹æ‹ ã«åŸºã¥ãè¨­è¨ˆã€å°‚é–€å®¶ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å……å®Ÿ |
| 3 | æ—¢å­˜Big5ã¨ã®æ•´åˆæ€§å•é¡Œ | Med | DBè¨­è¨ˆæ™‚ã«æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã€æ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®å½±éŸ¿ã‚’æœ€å°åŒ– |
| 4 | çµæœãƒ¬ãƒãƒ¼ãƒˆã®æƒ…å ±éå¤š | Med | ã‚¿ãƒ–/ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ†å‰²ã€ã‚µãƒãƒªãƒ¼ãƒ“ãƒ¥ãƒ¼å„ªå…ˆ |
| 5 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–ï¼ˆè³ªå•æ•°å¢—åŠ ï¼‰ | Low | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã€é…å»¶èª­ã¿è¾¼ã¿ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ |

---

## Phase 4: æŠ€è¡“è¨­è¨ˆ

### 4.1 DBè¨­è¨ˆ

#### æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- æ¤œæŸ»ã‚¿ã‚¤ãƒ—ãƒã‚¹ã‚¿
CREATE TABLE assessment_types (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    code TEXT UNIQUE NOT NULL, -- 'big5', 'disc', 'stress', 'eq', 'values'
    name TEXT NOT NULL,
    description TEXT,
    question_count INT NOT NULL,
    estimated_minutes INT NOT NULL,
    is_active BOOLEAN DEFAULT true,
    display_order INT DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- è³ªå•ãƒã‚¹ã‚¿ï¼ˆå…¨æ¤œæŸ»ã‚¿ã‚¤ãƒ—çµ±åˆï¼‰
CREATE TABLE assessment_questions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    assessment_type_id UUID REFERENCES assessment_types(id),
    question_text TEXT NOT NULL,
    question_order INT NOT NULL,
    dimension TEXT NOT NULL, -- 'D', 'I', 'S', 'C' for DISC, etc.
    reverse_scored BOOLEAN DEFAULT false,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- å›ç­”ï¼ˆæ—¢å­˜ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ or æ–°è¦ï¼‰
CREATE TABLE assessment_responses (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    candidate_id UUID REFERENCES candidates(id) ON DELETE CASCADE,
    assessment_type_id UUID REFERENCES assessment_types(id),
    question_id UUID REFERENCES assessment_questions(id),
    answer_value INT NOT NULL CHECK (answer_value BETWEEN 1 AND 5),
    answered_at TIMESTAMPTZ DEFAULT NOW(),
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- æ¤œæŸ»çµæœã‚¹ã‚³ã‚¢
CREATE TABLE assessment_scores (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    candidate_id UUID REFERENCES candidates(id) ON DELETE CASCADE,
    assessment_type_id UUID REFERENCES assessment_types(id),
    dimension TEXT NOT NULL,
    raw_score DECIMAL(5,2) NOT NULL,
    normalized_score DECIMAL(5,2) NOT NULL, -- 0-100
    percentile INT, -- æ¯é›†å›£æ¯”è¼ƒç”¨ï¼ˆå°†æ¥ï¼‰
    calculated_at TIMESTAMPTZ DEFAULT NOW(),
    created_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE (candidate_id, assessment_type_id, dimension)
);

-- RLSæœ‰åŠ¹åŒ–
ALTER TABLE assessment_types ENABLE ROW LEVEL SECURITY;
ALTER TABLE assessment_questions ENABLE ROW LEVEL SECURITY;
ALTER TABLE assessment_responses ENABLE ROW LEVEL SECURITY;
ALTER TABLE assessment_scores ENABLE ROW LEVEL SECURITY;

-- RLSãƒãƒªã‚·ãƒ¼: assessment_typesï¼ˆå…¨å“¡é–²è¦§å¯ï¼‰
CREATE POLICY "Anyone can view active assessment types"
    ON assessment_types FOR SELECT
    USING (is_active = true);

-- RLSãƒãƒªã‚·ãƒ¼: assessment_questionsï¼ˆå…¨å“¡é–²è¦§å¯ï¼‰
CREATE POLICY "Anyone can view questions"
    ON assessment_questions FOR SELECT
    USING (true);

-- RLSãƒãƒªã‚·ãƒ¼: assessment_responses
CREATE POLICY "Candidates can insert own responses"
    ON assessment_responses FOR INSERT
    WITH CHECK (true); -- å€™è£œè€…ãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ã§åˆ¶å¾¡

CREATE POLICY "Admins can view all responses"
    ON assessment_responses FOR SELECT
    USING (auth.role() = 'authenticated');

-- RLSãƒãƒªã‚·ãƒ¼: assessment_scores
CREATE POLICY "Admins can view all scores"
    ON assessment_scores FOR SELECT
    USING (auth.role() = 'authenticated');

CREATE POLICY "System can insert scores"
    ON assessment_scores FOR INSERT
    WITH CHECK (true); -- Edge FunctionçµŒç”±
```

#### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

```sql
CREATE INDEX idx_assessment_questions_type ON assessment_questions(assessment_type_id);
CREATE INDEX idx_assessment_responses_candidate ON assessment_responses(candidate_id);
CREATE INDEX idx_assessment_responses_type ON assessment_responses(assessment_type_id);
CREATE INDEX idx_assessment_scores_candidate ON assessment_scores(candidate_id);
CREATE INDEX idx_assessment_scores_type ON assessment_scores(assessment_type_id);
```

---

### 4.2 APIè¨­è¨ˆ

#### æ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| Method | Path | èª¬æ˜ | èªè¨¼ |
|--------|------|------|------|
| GET | /api/assessment/types | åˆ©ç”¨å¯èƒ½ãªæ¤œæŸ»ã‚¿ã‚¤ãƒ—ä¸€è¦§ | Public |
| GET | /api/assessment/types/:code/questions | æ¤œæŸ»ã®è³ªå•ä¸€è¦§ | Token |
| POST | /api/assessment/responses | å›ç­”ã‚’ä¿å­˜ | Token |
| POST | /api/assessment/complete | æ¤œæŸ»å®Œäº†ãƒ»ã‚¹ã‚³ã‚¢ç®—å‡º | Token |
| GET | /api/admin/candidates/:id/scores | å€™è£œè€…ã®å…¨æ¤œæŸ»ã‚¹ã‚³ã‚¢ | Admin |
| GET | /api/admin/candidates/:id/report | çµ±åˆãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ | Admin |

#### zodã‚¹ã‚­ãƒ¼ãƒ

```typescript
import { z } from 'zod';

// å›ç­”é€ä¿¡
export const submitResponseSchema = z.object({
  candidateId: z.string().uuid(),
  assessmentTypeCode: z.enum(['big5', 'disc', 'stress', 'eq', 'values']),
  responses: z.array(z.object({
    questionId: z.string().uuid(),
    value: z.number().int().min(1).max(5),
  })),
});

// æ¤œæŸ»å®Œäº†
export const completeAssessmentSchema = z.object({
  candidateId: z.string().uuid(),
  assessmentTypeCode: z.enum(['big5', 'disc', 'stress', 'eq', 'values']),
});

// ã‚¹ã‚³ã‚¢çµæœ
export const scoreResultSchema = z.object({
  assessmentType: z.string(),
  dimensions: z.array(z.object({
    name: z.string(),
    rawScore: z.number(),
    normalizedScore: z.number(),
    interpretation: z.string(),
  })),
  calculatedAt: z.string().datetime(),
});
```

---

### 4.3 UIè¨­è¨ˆ

#### ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ¢ãƒƒã‚¯

**Figma Link**: ï¼ˆä½œæˆäºˆå®šï¼‰
**v0 Link**: ï¼ˆä½œæˆäºˆå®šï¼‰

#### v0ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¡ˆ

```
Create an assessment page for personality tests.
Requirements:
- Progress bar showing current question / total questions
- Question text with 5-point Likert scale (strongly disagree to strongly agree)
- Previous / Next navigation buttons
- Save & Continue later button
- Assessment type indicator (DISC, Stress, EQ, Values)

Use shadcn/ui Card, RadioGroup, Button, Progress.
Japanese UI labels.
```

#### ç”»é¢ä¸€è¦§

| ç”»é¢ | ãƒ‘ã‚¹ | çŠ¶æ…‹ |
|------|------|------|
| æ¤œæŸ»é¸æŠ | /assessment/:token | æ–°è¦ |
| æ¤œæŸ»å®Ÿæ–½ | /assessment/:token/:type | æ–°è¦ |
| æ¤œæŸ»å®Œäº† | /assessment/:token/complete | æ—¢å­˜æ‹¡å¼µ |
| çµæœè©³ç´°ï¼ˆç®¡ç†è€…ï¼‰ | /admin/candidates/:id | æ—¢å­˜æ‹¡å¼µ |

#### data-testid å‘½å

| è¦ç´  | data-testid |
|------|-------------|
| è³ªå•ãƒ†ã‚­ã‚¹ãƒˆ | `question-text` |
| å›ç­”é¸æŠè‚¢ | `answer-option-{1-5}` |
| æ¬¡ã¸ãƒœã‚¿ãƒ³ | `next-button` |
| å‰ã¸ãƒœã‚¿ãƒ³ | `prev-button` |
| é€²æ—ãƒãƒ¼ | `progress-bar` |
| å®Œäº†ãƒœã‚¿ãƒ³ | `complete-button` |
| çµæœã‚¿ãƒ–ï¼ˆDISCï¼‰ | `result-tab-disc` |
| çµæœã‚¿ãƒ–ï¼ˆStressï¼‰ | `result-tab-stress` |
| çµæœã‚¿ãƒ–ï¼ˆEQï¼‰ | `result-tab-eq` |
| çµæœã‚¿ãƒ–ï¼ˆValuesï¼‰ | `result-tab-values` |

---

### 4.4 å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ‘ã‚¹ | å¤‰æ›´ç¨®åˆ¥ | èª¬æ˜ |
|-----|---------|------|
| `supabase/migrations/xxx_add_assessment_types.sql` | æ–°è¦ | æ¤œæŸ»ã‚¿ã‚¤ãƒ—ãƒ»è³ªå•ãƒ†ãƒ¼ãƒ–ãƒ« |
| `supabase/migrations/xxx_add_assessment_responses.sql` | æ–°è¦ | å›ç­”ãƒ»ã‚¹ã‚³ã‚¢ãƒ†ãƒ¼ãƒ–ãƒ« |
| `supabase/seed.sql` | å¤‰æ›´ | è³ªå•ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ |
| `src/lib/validations/assessment.ts` | æ–°è¦ | zodã‚¹ã‚­ãƒ¼ãƒ |
| `src/lib/assessment/scoring/` | æ–°è¦ | ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ |
| `src/lib/assessment/scoring/disc.ts` | æ–°è¦ | DISCç†è«–ã‚¹ã‚³ã‚¢ç®—å‡º |
| `src/lib/assessment/scoring/stress.ts` | æ–°è¦ | ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ã‚¹ã‚³ã‚¢ç®—å‡º |
| `src/lib/assessment/scoring/eq.ts` | æ–°è¦ | EQã‚¹ã‚³ã‚¢ç®—å‡º |
| `src/lib/assessment/scoring/values.ts` | æ–°è¦ | ä¾¡å€¤è¦³ã‚¹ã‚³ã‚¢ç®—å‡º |
| `src/app/assessment/[token]/[type]/page.tsx` | æ–°è¦ | æ¤œæŸ»å®Ÿæ–½ç”»é¢ |
| `src/components/assessment/QuestionCard.tsx` | æ–°è¦ | è³ªå•ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| `src/components/assessment/ProgressBar.tsx` | æ–°è¦ | é€²æ—ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| `src/app/admin/candidates/[id]/page.tsx` | å¤‰æ›´ | çµæœè¡¨ç¤ºæ‹¡å¼µ |
| `src/components/admin/results/ExtendedResults.tsx` | æ–°è¦ | æ‹¡å¼µçµæœè¡¨ç¤º |
| `src/components/admin/results/DISCChart.tsx` | æ–°è¦ | DISCãƒãƒ£ãƒ¼ãƒˆ |
| `src/components/admin/results/EQRadar.tsx` | æ–°è¦ | EQãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ |

---

## Phase 5: ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

### 5.1 Gold E2E å€™è£œåˆ¤å®š

**Gold E2E å¯¾è±¡ã‹ï¼Ÿ**: [x] ã¯ã„

#### 5ã¤ã®ãƒ¬ãƒ³ã‚ºè©•ä¾¡

| # | ãƒ¬ãƒ³ã‚º | Yes/No | æ ¹æ‹  |
|---|--------|--------|------|
| 1 | å£Šã‚ŒãŸã‚‰å›°ã‚‹ã‹ï¼Ÿ | Yes | æ¤œæŸ»çµæœãŒä¸æ­£ç¢ºã ã¨æ¡ç”¨åˆ¤æ–­ã«å½±éŸ¿ |
| 2 | å®Ÿè£…ã§ã¯ãªãæŒ¯ã‚‹èˆã„ã‚’è¦‹ã¦ã‚‹ã‹ï¼Ÿ | Yes | æ¤œæŸ»å®Ÿæ–½â†’çµæœè¡¨ç¤ºã®ãƒ•ãƒ­ãƒ¼æ¤œè¨¼ |
| 3 | å˜˜ã‚’ã¤ã„ã¦é€šã‚Œãªã„ã‹ï¼Ÿ | Yes | å®Ÿéš›ã®å›ç­”ãƒ‡ãƒ¼ã‚¿ãŒDBã«ä¿å­˜ãƒ»è¨ˆç®—ã•ã‚Œã‚‹å¿…è¦ |
| 4 | è½ã¡ãŸç†ç”±ã‚’1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‹ï¼Ÿ | Yes | ã€Œå€™è£œè€…ãŒæ¤œæŸ»ã‚’å®Œäº†ã—çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€ |
| 5 | ç„¡ã„ã¨ä½•ã‚’è«¦ã‚ã‚‹ã‹ï¼Ÿ | Yes | æ€§æ ¼æ¤œæŸ»ã®ä¿¡é ¼æ€§ä¿è¨¼ã‚’è«¦ã‚ã‚‹ |

**åˆ¤å®š**: 5ã¤ã™ã¹ã¦ Yes â†’ **Gold E2E æ¡ç”¨**

---

### 5.2 ãƒˆãƒªã‚¢ãƒ¼ã‚¸ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

| è»¸ | ã‚¹ã‚³ã‚¢ (1-5) | æ ¹æ‹  |
|----|-------------|------|
| Impactï¼ˆå£²ä¸Š/é¡§å®¢ä½“é¨“ã¸ã®å½±éŸ¿ï¼‰ | 5 | æ¤œæŸ»çµæœã®ä¿¡é ¼æ€§ã¯æ¡ç”¨åˆ¤æ–­ã®æ ¹å¹¹ |
| Frequencyï¼ˆä½¿ç”¨é »åº¦ï¼‰ | 5 | å…¨å€™è£œè€…ãŒæ¤œæŸ»ã‚’å—é¨“ |
| Detectabilityï¼ˆæ¤œçŸ¥ã®é›£ã—ã•ï¼‰ | 4 | ã‚¹ã‚³ã‚¢ç®—å‡ºãƒ­ã‚¸ãƒƒã‚¯ã®ãƒã‚°ã¯ç™ºè¦‹å›°é›£ |
| Recovery Costï¼ˆå¾©æ—§ã‚³ã‚¹ãƒˆï¼‰ | 4 | èª¤ã£ãŸçµæœãŒæ¡ç”¨åˆ¤æ–­ã«ä½¿ã‚ã‚Œã‚‹ã¨å–ã‚Šè¿”ã—ãŒã¤ã‹ãªã„ |
| **åˆè¨ˆ** | **18/20** | **å¿…é ˆï¼ˆGold E2E ç¢ºå®šï¼‰** |

---

### 5.3 GWTä»•æ§˜ï¼ˆGold E2Eï¼‰

#### GS-148-001: å€™è£œè€…ãŒæ‹¡å¼µæ¤œæŸ»ã‚’å®Œäº†ã™ã‚‹

```gherkin
Feature: æ‹¡å¼µæ€§æ ¼æ¤œæŸ»
  As a å€™è£œè€…
  I want to è¡Œå‹•ç‰¹æ€§ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ãƒ»EQãƒ»ä¾¡å€¤è¦³ã®æ¤œæŸ»ã‚’å—ã‘ã‚‹
  So that è‡ªåˆ†ã®ç‰¹æ€§ã‚’ä¼æ¥­ã«ä¼ãˆã‚‰ã‚Œã‚‹

  Scenario: DISCè¡Œå‹•ç‰¹æ€§æ¤œæŸ»ã‚’å®Œäº†ã™ã‚‹
    Given å€™è£œè€…ãŒæ¤œæŸ»ãƒªãƒ³ã‚¯ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹
      And Big5æ¤œæŸ»ãŒå®Œäº†ã—ã¦ã„ã‚‹
    When ã€Œè¡Œå‹•ç‰¹æ€§æ¤œæŸ»ã‚’é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
      And å…¨ã¦ã®è³ªå•ã«å›ç­”ã™ã‚‹
      And ã€Œå®Œäº†ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
    Then ã€Œæ¤œæŸ»ãŒå®Œäº†ã—ã¾ã—ãŸã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
      And æ¬¡ã®æ¤œæŸ»ï¼ˆã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ï¼‰ãŒé¸æŠå¯èƒ½ã«ãªã‚‹
```

#### GS-148-002: ç®¡ç†è€…ãŒæ‹¡å¼µæ¤œæŸ»çµæœã‚’é–²è¦§ã™ã‚‹

```gherkin
Feature: æ‹¡å¼µæ¤œæŸ»çµæœé–²è¦§
  As a ç®¡ç†è€…
  I want to å€™è£œè€…ã®æ‹¡å¼µæ¤œæŸ»çµæœã‚’ç¢ºèªã™ã‚‹
  So that å¤šé¢çš„ãªäººç‰©ç†è§£ã«åŸºã¥ã„ã¦æ¡ç”¨åˆ¤æ–­ã§ãã‚‹

  Scenario: å…¨æ¤œæŸ»çµæœã‚’é–²è¦§ã™ã‚‹
    Given ç®¡ç†è€…ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹
      And å€™è£œè€…ãŒå…¨ã¦ã®æ¤œæŸ»ã‚’å®Œäº†ã—ã¦ã„ã‚‹
    When å€™è£œè€…è©³ç´°ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹
    Then Big5çµæœãŒè¡¨ç¤ºã•ã‚Œã‚‹
      And DISCçµæœã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã‚‹
      And ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§ã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã‚‹
      And EQã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã‚‹
      And ä¾¡å€¤è¦³ã‚¿ãƒ–ãŒè¡¨ç¤ºã•ã‚Œã‚‹
```

#### Playwrightãƒãƒƒãƒ”ãƒ³ã‚°

| GWT Step | Playwrightå®Ÿè£… |
|----------|---------------|
| Given å€™è£œè€…ãŒæ¤œæŸ»ãƒªãƒ³ã‚¯ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ | `await page.goto('/assessment/:token')` |
| When ã€Œè¡Œå‹•ç‰¹æ€§æ¤œæŸ»ã‚’é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ | `await page.click('[data-testid="start-disc"]')` |
| And å…¨ã¦ã®è³ªå•ã«å›ç­”ã™ã‚‹ | `for (q of questions) { await page.click('[data-testid="answer-option-3"]'); await page.click('[data-testid="next-button"]'); }` |
| Then ã€Œæ¤œæŸ»ãŒå®Œäº†ã—ã¾ã—ãŸã€ãŒè¡¨ç¤º | `await expect(page.getByText('æ¤œæŸ»ãŒå®Œäº†ã—ã¾ã—ãŸ')).toBeVisible()` |

---

### 5.4 å˜ä½“ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

| å¯¾è±¡é–¢æ•°/ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æœŸå¾…çµæœ |
|----------------------|------------|---------|
| `calculateDISCScore()` | æ­£å¸¸ç³»: å…¨å›ç­”ã‚ã‚Š | 4æ¬¡å…ƒã‚¹ã‚³ã‚¢ç®—å‡º |
| | ç•°å¸¸ç³»: å›ç­”æ¬ æ | ã‚¨ãƒ©ãƒ¼ã‚¹ãƒ­ãƒ¼ |
| | å¢ƒç•Œå€¤: å…¨ã¦1 / å…¨ã¦5 | æ¥µç«¯ãªã‚¹ã‚³ã‚¢ |
| `calculateStressScore()` | æ­£å¸¸ç³»: å…¨å›ç­”ã‚ã‚Š | è€æ€§ãƒ»å›å¾©åŠ›ã‚¹ã‚³ã‚¢ |
| `calculateEQScore()` | æ­£å¸¸ç³»: å…¨å›ç­”ã‚ã‚Š | 4é ˜åŸŸã‚¹ã‚³ã‚¢ |
| `calculateValuesScore()` | æ­£å¸¸ç³»: å…¨å›ç­”ã‚ã‚Š | ä¾¡å€¤è¦³ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« |
| `QuestionCard` | ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° | è³ªå•ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º |
| | å›ç­”é¸æŠ | é¸æŠçŠ¶æ…‹å¤‰æ›´ |
| `ProgressBar` | é€²æ—è¡¨ç¤º | æ­£ã—ã„ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ |

---

### 5.5 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

```
UC-ASSESS-CAND-CONDUCT-WEB
  â””â”€â†’ GS-148-001: å€™è£œè€…ãŒæ‹¡å¼µæ¤œæŸ»ã‚’å®Œäº†ã™ã‚‹
       â””â”€â†’ PW: e2e/gold/assessment-extended.spec.ts
            â””â”€â†’ CI: e2e.yml (Gold E2E Stage)

UC-ASSESS-ADMIN-VIEW-WEB
  â””â”€â†’ GS-148-002: ç®¡ç†è€…ãŒæ‹¡å¼µæ¤œæŸ»çµæœã‚’é–²è¦§ã™ã‚‹
       â””â”€â†’ PW: e2e/gold/admin-results-extended.spec.ts
            â””â”€â†’ CI: e2e.yml (Gold E2E Stage)
```

| UC-ID | GS-ID | PW File | CI Stage |
|-------|-------|---------|----------|
| UC-ASSESS-CAND-CONDUCT-WEB | GS-148-001 | assessment-extended.spec.ts | Gold E2E |
| UC-ASSESS-ADMIN-VIEW-WEB | GS-148-002 | admin-results-extended.spec.ts | Gold E2E |

---

### 5.6 Goldå®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Secrets: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãªã—ã€ç’°å¢ƒå¤‰æ•°ä½¿ç”¨
- [ ] Selectors: data-testid ãƒ™ãƒ¼ã‚¹ã€class/xpath ç¦æ­¢
- [ ] Local: `npx playwright test assessment-extended.spec.ts` æˆåŠŸ
- [ ] CI: GitHub Actions E2E æˆåŠŸ

---

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚ºåˆ†å‰²

Issue #148 ã¯å¤§è¦æ¨¡ãªãŸã‚ã€ä»¥ä¸‹ã®ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã«åˆ†å‰²ï¼š

| Phase | å†…å®¹ | è¦‹ç©ã‚Š | ä¾å­˜ |
|-------|------|--------|------|
| 1 | DBè¨­è¨ˆãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | - | - |
| 2 | è¡Œå‹•ç‰¹æ€§ï¼ˆDISCï¼‰å®Ÿè£… | - | Phase 1 |
| 3 | ã‚¹ãƒˆãƒ¬ã‚¹è€æ€§å®Ÿè£… | - | Phase 1 |
| 4 | EQå®Ÿè£… | - | Phase 1 |
| 5 | ä¾¡å€¤è¦³è¨ºæ–­å®Ÿè£… | - | Phase 1 |
| 6 | çµæœè¡¨ç¤ºçµ±åˆãƒ»E2Eãƒ†ã‚¹ãƒˆ | - | Phase 2-5 |

---

## æ‰¿èª

| ãƒ­ãƒ¼ãƒ« | åå‰ | æ‰¿èªæ—¥ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|--------|------|--------|-----------|
| ä½œæˆè€… | @claude-code | 2025-12-30 | Draft |
| ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ | | | |
| æ‰¿èªè€… | | | |

---

## æ›´æ–°å±¥æ­´

| æ—¥ä»˜ | å†…å®¹ | æ›´æ–°è€… |
|-----|------|--------|
| 2025-12-30 | åˆç‰ˆä½œæˆ | @claude-code |

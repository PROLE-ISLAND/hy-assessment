# HY Assessment - 開発ロードマップ

**更新日**: 2024-12-23
**ステータス**: MVP完了 → フェーズ2拡張中

---

# 1. ビジネス目的と本質的要件

## 1.1 Why - なぜこのシステムが必要か

### 解決したい課題（Pain Points）

| 課題 | 現状の問題 | 影響 |
|-----|----------|------|
| **面接の限界** | 短時間の面接では候補者の本質が見えない | 採用後のミスマッチ、早期離職 |
| **属人的判断** | 面接官の経験・感覚に依存 | 判断のばらつき、バイアス |
| **確認漏れ** | 聞くべきポイントが曖昧 | 重要な特性の見落とし |
| **比較困難** | 候補者間の客観的比較ができない | 最適な人材の見逃し |
| **時間コスト** | 採用判断に時間がかかる | 優秀な人材の逃失 |

### ターゲットユーザーの声（想定）

> 「面接では好印象だったけど、入社後に問題が発覚することがある」
> 「候補者AとBのどちらが適任か、客観的に判断したい」
> 「面接で何を確認すべきか、事前にわかっていると助かる」
> 「忙しい中で効率的に候補者を評価したい」

## 1.2 What - 何を実現するか

### ゴール（成功状態）

```
採用担当者が、候補者の検査結果を見て、
「この人は○○が強みで、△△は面接で確認すべき」と
即座に判断でき、採用プロセスを効率化できている状態
```

### 成果指標（KPI候補）

| 指標 | 説明 | 目標値 |
|-----|------|-------|
| 検査完了率 | 発行した検査のうち完了した割合 | 90%以上 |
| 採用判断時間 | 検査結果確認から判断までの時間 | 50%短縮 |
| 採用後ミスマッチ率 | 入社1年以内の問題発生率 | 30%削減 |
| ユーザー満足度 | 採用担当者の満足度 | 4.0/5.0以上 |

## 1.3 Who - 誰が使うか

### プライマリユーザー：採用担当者

**ペルソナ**:
- 30-40代、人事部門所属
- 月に10-30人の候補者を評価
- 多忙で効率を重視
- ITリテラシーは中程度

**ニーズ**:
1. 候補者の「見るべきポイント」を素早く把握したい
2. 複数候補者を客観的に比較したい
3. 面接で確認すべき点を事前に知りたい
4. 判断の根拠を上司に説明したい

### セカンダリユーザー：候補者

**ニーズ**:
- スムーズに検査を完了したい
- 自分の結果（一部）を知りたい（将来機能）

---

# 2. ダッシュボード再設計

## 2.1 現状の問題点

### 現在のダッシュボード

```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│ 候補者数    │ 検査数      │ 完了        │ 未完了      │
│ (総数)      │ (総数)      │ (総数)      │ (総数)      │
└─────────────┴─────────────┴─────────────┴─────────────┘

┌─────────────────────────────────────────────────────────┐
│ 検査推移チャート（14日間）                              │
│ AreaChart: 開始数 / 完了数                              │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ スコア分布                                              │
│ BarChart: 0-20 / 21-40 / 41-60 / 61-80 / 81-100        │
└─────────────────────────────────────────────────────────┘
```

### 問題点

| 問題 | 詳細 | 影響 |
|-----|------|------|
| **アクション不在** | 「次に何をすべきか」がわからない | ダッシュボードを見ても行動に繋がらない |
| **優先度不明** | どの候補者を先に見るべきか不明 | 重要な候補者の見落とし |
| **期限管理なし** | 期限切れ間近の検査が見えない | 検査の無駄発行 |
| **判断支援なし** | 要注意・高評価候補者が一目でわからない | 効率的なスクリーニング不可 |

## 2.2 あるべき姿（To-Be）

### コンセプト：「今日やるべきことが一目でわかるダッシュボード」

```
┌─────────────────────────────────────────────────────────┐
│ 🔔 アクション必要 (3件)                                 │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ ⚠️ 期限切れ間近 (2件)  │  📊 分析待ち (1件)        │ │
│ │ ・山田太郎 - 残り2日    │  ・佐藤花子 - 完了済み    │ │
│ │ ・鈴木一郎 - 残り1日    │                          │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘

┌───────────────────────┬───────────────────────┐
│ 📈 採用パイプライン    │ 🎯 注目候補者          │
│ ┌────────┐            │ ┌────────────────────┐ │
│ │未検査  │ 5人        │ │ ⭐ 高評価 (2人)    │ │
│ │回答中  │ 3人        │ │ ・田中 - 85%       │ │
│ │完了    │ 12人       │ │ ・高橋 - 82%       │ │
│ │分析済  │ 10人       │ ├────────────────────┤ │
│ └────────┘            │ │ ⚠️ 要確認 (1人)    │ │
│                       │ │ ・中村 - COG高め   │ │
│                       │ └────────────────────┘ │
└───────────────────────┴───────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📊 今週の検査状況                                       │
│ [より詳細なチャート - 日別・完了率・平均スコア]         │
└─────────────────────────────────────────────────────────┘
```

## 2.3 必要な機能

### Priority 1: アクション誘導

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **期限アラート** | 期限切れ3日以内の検査を警告表示 | 低 |
| **分析待ちリスト** | 完了済み・未分析の検査を表示 | 低 |
| **クイックアクション** | ワンクリックで詳細/リマインド/分析実行 | 中 |

### Priority 2: パイプライン可視化

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **ステータスファネル** | 未検査→回答中→完了→分析済みの流れ | 中 |
| **停滞検知** | 長期間進捗のない候補者を警告 | 中 |
| **完了率表示** | 期間別の検査完了率 | 低 |

### Priority 3: 判断支援

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **高評価候補者** | 総合スコア80%以上を自動ハイライト | 低 |
| **要確認候補者** | COG高め/VALID低めを警告表示 | 低 |
| **職種別ランキング** | 同一職種内での順位表示 | 中 |

---

# 3. レポートページ再設計

## 3.1 現状の問題点

### 現在のレポートページ

```
┌─────────────────────────────────────────────────────────┐
│ サマリー統計 (分析済み件数 / 全体平均 / 職種数)         │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ ドメイン別分析                                          │
│ GOV: ████████████░░░░ 75% (良好)                       │
│ CONFLICT: ██████████░░░░░░ 68% (標準)                  │
│ ...                                                     │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 職種別分析                                              │
│ アカウントマネージャー: 3人 / 72% / →                  │
│ エンジニア: 5人 / 78% / ↑                              │
│ ...                                                     │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ インサイト                                              │
│ ・強みの傾向: GOVが最も高い                            │
│ ・改善の余地: CONFLICTが相対的に低い                   │
└─────────────────────────────────────────────────────────┘
```

### 問題点

| 問題 | 詳細 | 影響 |
|-----|------|------|
| **全体俯瞰のみ** | 個別候補者の比較ができない | 採用判断に直結しない |
| **アクションなし** | 「で、どうすればいい？」がない | 情報だけで終わる |
| **面接連携なし** | 面接で確認すべき点がわからない | 検査結果が活用されない |
| **判断基準なし** | 推奨/非推奨の明示がない | 判断を担当者に丸投げ |

## 3.2 あるべき姿（To-Be）

### コンセプト：「採用判断を支援するレポート」

```
┌─────────────────────────────────────────────────────────┐
│ 🎯 採用判断サマリー                                     │
│ ┌─────────────┬─────────────┬─────────────┐            │
│ │ ⭐ 推奨     │ 🔍 要検討   │ ⚠️ 慎重検討 │            │
│ │ 3人        │ 5人         │ 2人         │            │
│ └─────────────┴─────────────┴─────────────┘            │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📋 候補者比較（同一職種）                               │
│ ┌────────┬────────┬────────┬────────┬────────┐         │
│ │ 名前   │ GOV    │ CONF   │ REL    │ 総合   │ 判定   │
│ ├────────┼────────┼────────┼────────┼────────┤         │
│ │ 田中   │ 85%    │ 78%    │ 80%    │ 82%    │ ⭐     │
│ │ 佐藤   │ 72%    │ 75%    │ 68%    │ 71%    │ 🔍     │
│ │ 高橋   │ 65%    │ 58%    │ 62%    │ 60%    │ ⚠️     │
│ └────────┴────────┴────────┴────────┴────────┘         │
│ [レーダーチャート比較]                                  │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📝 面接確認ポイント（候補者別）                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 田中太郎                                           │ │
│ │ ✅ 強み: ガバナンス意識が高く、ルール遵守の姿勢    │ │
│ │ ❓ 確認: 対立場面での対応経験を聞く               │ │
│ │    → CONFLICTスコアが相対的に低め                 │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 📊 傾向分析                                             │
│ ・今期の候補者は全体的にWORKスコアが高い傾向           │
│ ・営業職候補者のCONFLICTスコアに注意が必要             │
│ ・前期比: 平均スコア +5%                               │
└─────────────────────────────────────────────────────────┘
```

## 3.3 必要な機能

### Priority 1: 判断支援

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **判定ラベル** | 推奨/要検討/慎重検討の3段階自動分類 | 中 |
| **判定理由** | なぜその判定になったか説明 | 中 |
| **閾値設定** | 組織ごとに判定基準をカスタマイズ | 高 |

### Priority 2: 比較機能

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **候補者比較表** | 同一職種の候補者を横並び比較 | 中 |
| **レーダーチャート重ね合わせ** | 複数候補者のスコアを視覚比較 | 中 |
| **ランキング表示** | 総合スコアによる順位付け | 低 |

### Priority 3: 面接連携

| 機能 | 説明 | 実装難度 |
|-----|------|---------|
| **面接ポイント自動生成** | AIが確認すべき点を提案 | 中（AI活用） |
| **質問例サジェスト** | スコアに基づく質問例 | 中 |
| **印刷用レイアウト** | 面接時に持参できる形式 | 低 |

---

# 4. 機能不足・改善点一覧

## 4.1 未実装機能

| カテゴリ | 機能 | 優先度 | 難度 | 説明 |
|---------|------|--------|------|------|
| **通知** | メール通知 | 高 | 中 | 検査完了・期限切れ通知 |
| **通知** | Slack連携 | 中 | 中 | リアルタイム通知 |
| **比較** | 候補者比較画面 | 高 | 中 | 複数候補者の横並び比較 |
| **比較** | レーダーチャート重ね合わせ | 中 | 中 | 視覚的比較 |
| **面接** | 面接ポイント表示 | 高 | 中 | 確認すべき点のサジェスト |
| **面接** | 面接シート印刷 | 中 | 低 | 面接用PDF |
| **設定** | 判定閾値カスタマイズ | 中 | 中 | 組織ごとの基準設定 |
| **設定** | ユーザー管理 | 高 | 中 | 複数ユーザー対応 |
| **分析** | 期間比較 | 低 | 中 | 今期vs前期 |
| **分析** | 採用後追跡 | 低 | 高 | 入社後のパフォーマンス連携 |

## 4.2 既存機能の改善点

| ページ | 問題 | 改善案 | 優先度 |
|-------|------|--------|--------|
| **ダッシュボード** | アクション不在 | アクション必要セクション追加 | 高 |
| **ダッシュボード** | パイプライン不可視 | ステータスファネル追加 | 高 |
| **ダッシュボード** | 注目候補者不明 | 高評価/要確認ハイライト | 高 |
| **レポート** | 個別比較不可 | 候補者比較表追加 | 高 |
| **レポート** | 判断支援なし | 判定ラベル自動付与 | 高 |
| **レポート** | 面接連携なし | 面接ポイント表示 | 高 |
| **候補者詳細** | 情報不足 | 過去の検査履歴表示 | 中 |
| **検査結果詳細** | グラフ不足 | ドメイン別詳細チャート | 中 |
| **テンプレート** | 編集制限 | SurveyJSフル編集（ライセンス要） | 低 |

## 4.3 UI/UXデザイン改善点

| 箇所 | 現状 | 改善案 | 優先度 |
|-----|------|--------|--------|
| **全体** | 統一感不足 | デザインシステム整備 | 中 |
| **カード** | シンプルすぎ | アイコン・色分け強化 | 中 |
| **テーブル** | 情報過多 | 重要項目ハイライト | 中 |
| **チャート** | 基本的 | インタラクティブ化 | 低 |
| **ナビ** | 階層不明 | パンくずリスト追加 | 低 |
| **レスポンシブ** | 未対応箇所あり | モバイル最適化 | 中 |
| **ローディング** | 基本的 | スケルトンUI導入 | 低 |
| **エラー** | 簡素 | 親切なエラー画面 | 低 |

---

# 5. 開発TODO（優先順位付き）

## 5.1 Phase 2A: ダッシュボード強化（優先度：高）

### Sprint 1: アクション誘導

- [ ] **期限アラートコンポーネント作成**
  - 期限3日以内の検査を取得するクエリ
  - アラートカードUI（警告色、候補者名、残り日数）
  - 詳細ページへのリンク

- [ ] **分析待ちリストコンポーネント作成**
  - status=completed かつ ai_analyses未存在を取得
  - リストUI（候補者名、完了日時）
  - 分析実行ボタン（ワンクリック分析）

- [ ] **アクション必要セクション統合**
  - ダッシュボード上部に配置
  - 件数バッジ表示
  - 折りたたみ可能

### Sprint 2: パイプライン可視化

- [ ] **ステータスファネルコンポーネント作成**
  - 未検査/回答中/完了/分析済みの4段階
  - 各ステータスの人数取得
  - ビジュアルファネル表示（shadcn Progress活用）

- [ ] **注目候補者セクション作成**
  - 高評価（総合80%以上）リスト
  - 要確認（COG>60% or VALID<60%）リスト
  - クイックアクセスリンク

## 5.2 Phase 2B: レポート強化（優先度：高）

### Sprint 3: 判断支援

- [ ] **判定ロジック実装**
  - 判定基準定義（推奨: 75%以上、要検討: 50-75%、慎重: 50%未満）
  - 判定計算関数
  - 判定理由生成

- [ ] **判定サマリーセクション作成**
  - 3段階の人数表示
  - クリックで該当候補者一覧へ

### Sprint 4: 比較機能

- [ ] **候補者比較ページ作成**
  - `/admin/compare` 新規ページ
  - 候補者選択UI（チェックボックス）
  - 比較表コンポーネント

- [ ] **レーダーチャート重ね合わせ**
  - Recharts RadarChartで複数データ重ね表示
  - 候補者別の色分け
  - 凡例表示

### Sprint 5: 面接連携

- [ ] **面接ポイント生成ロジック**
  - スコアに基づくポイント自動生成
  - 低スコアドメインの確認質問サジェスト

- [ ] **面接ポイントUI**
  - 候補者詳細ページに追加
  - 強み/確認点の明示
  - 印刷対応レイアウト

## 5.3 Phase 2C: 通知・設定（優先度：中）

### Sprint 6: 通知基盤

- [ ] **通知テーブル設計・作成**
- [ ] **メール送信基盤（Resend/SendGrid）**
- [ ] **検査完了通知実装**
- [ ] **期限アラート通知実装**

### Sprint 7: ユーザー管理

- [ ] **ユーザー一覧ページ**
- [ ] **ユーザー招待機能**
- [ ] **ロール管理（admin/recruiter/viewer）**

## 5.4 Phase 2D: UI/UX改善（優先度：中）

### Sprint 8: デザイン改善

- [ ] **パンくずリスト追加**
- [ ] **スケルトンローディング導入**
- [ ] **カード・テーブルのビジュアル強化**
- [ ] **レスポンシブ対応強化**

---

# 6. 技術的考慮事項

## 6.1 パフォーマンス

| 懸念 | 対策 |
|-----|------|
| 大量候補者での集計 | インデックス最適化、キャッシュ導入 |
| チャート描画 | データ件数制限、遅延ロード |
| AI分析コスト | バッチ処理、キュー管理 |

## 6.2 セキュリティ

| 懸念 | 対策 |
|-----|------|
| 組織間データ漏洩 | RLS徹底、クエリ監査 |
| 検査URL推測 | 十分な長さのトークン（UUID v4） |
| API認証 | Supabase Auth + JWT検証 |

## 6.3 拡張性

| 将来機能 | 現時点の備え |
|---------|-------------|
| カスタムテンプレート | テンプレートテーブル設計済み |
| 多言語対応 | UI文字列の分離（未実施） |
| 外部連携 | API設計の一貫性維持 |

---

# 7. 参考資料

- [プロジェクト計画書](../CLAUDE.md内のplan)
- [データベース設計](../supabase/migrations/)
- [型定義](../src/types/database.ts)
- [分析エンジン](../src/lib/analysis/)

---

# 8. 具体的実装設計

## 8.1 ダッシュボード改善：アクション必要セクション

### データ取得クエリ

```sql
-- 期限切れ間近（3日以内）
SELECT a.id, c.name, p.name as person_name, a.expires_at
FROM assessments a
JOIN candidates c ON a.candidate_id = c.id
JOIN persons p ON c.person_id = p.id
WHERE a.organization_id = ?
  AND a.status IN ('pending', 'in_progress')
  AND a.expires_at BETWEEN NOW() AND NOW() + INTERVAL '3 days'
  AND a.deleted_at IS NULL
ORDER BY a.expires_at ASC;

-- 分析待ち（完了済み・未分析）
SELECT a.id, c.name, p.name as person_name, a.completed_at
FROM assessments a
JOIN candidates c ON a.candidate_id = c.id
JOIN persons p ON c.person_id = p.id
LEFT JOIN ai_analyses aa ON a.id = aa.assessment_id AND aa.is_latest = true
WHERE a.organization_id = ?
  AND a.status = 'completed'
  AND aa.id IS NULL
  AND a.deleted_at IS NULL;
```

### コンポーネント設計

```typescript
// src/components/dashboard/ActionRequiredSection.tsx
interface ActionItem {
  type: 'expiring' | 'needs_analysis';
  id: string;
  candidateName: string;
  detail: string; // 残り日数 or 完了日時
}

interface ActionRequiredSectionProps {
  expiringItems: ActionItem[];
  needsAnalysisItems: ActionItem[];
}
```

### UI設計

```
┌─────────────────────────────────────────────────────────┐
│ 🔔 アクション必要 (5件)                      [折りたたみ]│
├─────────────────────────────────────────────────────────┤
│ ⚠️ 期限切れ間近 (3件)                                   │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 山田太郎   残り2日   [詳細] [リマインド送信]        │ │
│ │ 鈴木一郎   残り1日   [詳細] [リマインド送信]        │ │
│ │ 佐藤花子   残り3日   [詳細] [リマインド送信]        │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ 📊 分析待ち (2件)                                       │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 高橋誠    12/22完了  [詳細] [分析実行]              │ │
│ │ 田中美咲  12/21完了  [詳細] [分析実行]              │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

## 8.2 ダッシュボード改善：パイプラインファネル

### データ取得

```typescript
// ステータス別カウント
const pipelineCounts = {
  未検査: candidates.filter(c => !c.assessments?.length).length,
  回答中: assessments.filter(a => a.status === 'in_progress').length,
  完了待ち: assessments.filter(a => a.status === 'completed' && !a.ai_analysis).length,
  分析済み: assessments.filter(a => a.ai_analysis).length,
};
```

### UI設計

```
┌───────────────────────────────────────────┐
│ 📈 採用パイプライン                        │
├───────────────────────────────────────────┤
│  未検査  ████████████████████████  5人     │
│  回答中  ██████████████            3人     │
│  完了    ████████                  2人     │
│  分析済  ████████████████████████  10人    │
└───────────────────────────────────────────┘
```

## 8.3 ダッシュボード改善：注目候補者

### データ取得

```sql
-- 高評価候補者（総合80%以上）
SELECT c.id, p.name,
       (aa.scores->>'GOV')::int + (aa.scores->>'CONFLICT')::int +
       (aa.scores->>'REL')::int + (aa.scores->>'COG')::int +
       (aa.scores->>'WORK')::int) / 5 as overall
FROM ai_analyses aa
JOIN assessments a ON aa.assessment_id = a.id
JOIN candidates c ON a.candidate_id = c.id
JOIN persons p ON c.person_id = p.id
WHERE aa.is_latest = true
  AND a.organization_id = ?
HAVING overall >= 80
ORDER BY overall DESC
LIMIT 5;

-- 要確認候補者（COG>60% or VALID<60%）
SELECT c.id, p.name, aa.scores
FROM ai_analyses aa
JOIN assessments a ON aa.assessment_id = a.id
JOIN candidates c ON a.candidate_id = c.id
JOIN persons p ON c.person_id = p.id
WHERE aa.is_latest = true
  AND a.organization_id = ?
  AND ((aa.scores->>'COG')::int > 60 OR (aa.scores->>'VALID')::int < 60);
```

### UI設計

```
┌───────────────────────────────────────────┐
│ 🎯 注目候補者                              │
├───────────────────────────────────────────┤
│ ⭐ 高評価 (3人)                            │
│   田中太郎  85%  営業職                    │
│   高橋誠    82%  エンジニア                │
│   山本花子  80%  マーケ                    │
├───────────────────────────────────────────┤
│ ⚠️ 要確認 (2人)                            │
│   中村一郎  COG 65%  確認推奨              │
│   小林美咲  VALID 55%  回答注意            │
└───────────────────────────────────────────┘
```

## 8.4 レポート改善：判定ロジック

### 判定基準

```typescript
type JudgmentLevel = 'recommended' | 'consider' | 'caution';

interface JudgmentCriteria {
  recommended: {
    overallMin: 75,
    cogMax: 40,
    validMin: 70,
  },
  consider: {
    overallMin: 50,
    cogMax: 60,
    validMin: 60,
  },
  // それ以外は caution
}

function calculateJudgment(scores: DomainScores): JudgmentLevel {
  const overall = calculateOverall(scores);
  const cog = scores.COG;
  const valid = scores.VALID;

  if (overall >= 75 && cog <= 40 && valid >= 70) {
    return 'recommended';
  }
  if (overall >= 50 && cog <= 60 && valid >= 60) {
    return 'consider';
  }
  return 'caution';
}
```

### 判定理由生成

```typescript
function generateJudgmentReason(scores: DomainScores, judgment: JudgmentLevel): string[] {
  const reasons: string[] = [];

  if (judgment === 'recommended') {
    reasons.push(`総合スコア${calculateOverall(scores)}%と高水準`);
    if (scores.GOV >= 80) reasons.push('ガバナンス意識が特に高い');
  }

  if (judgment === 'caution') {
    if (scores.COG > 60) reasons.push('認知スタイルに注意（被害者意識傾向）');
    if (scores.VALID < 60) reasons.push('回答の妥当性に疑問');
  }

  return reasons;
}
```

## 8.5 レポート改善：候補者比較

### 新規ページ設計

**URL**: `/admin/compare`

### 機能

1. 職種フィルター（同一職種の候補者を表示）
2. チェックボックスで比較対象を選択（最大5人）
3. 比較表表示
4. レーダーチャート重ね合わせ

### UI設計

```
┌─────────────────────────────────────────────────────────┐
│ 候補者比較                                              │
├─────────────────────────────────────────────────────────┤
│ 職種: [営業職 ▼]  比較対象: 3人選択中  [比較する]      │
├─────────────────────────────────────────────────────────┤
│ □ 田中太郎   85%  ⭐推奨                                │
│ ☑ 山田一郎   72%  🔍要検討                              │
│ ☑ 佐藤花子   65%  ⚠️慎重                               │
│ ☑ 高橋誠     78%  🔍要検討                              │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ 比較結果                                                │
├────────┬────────┬────────┬────────┬────────┬──────────┤
│ 名前   │ GOV    │ CONF   │ REL    │ WORK   │ 総合     │
├────────┼────────┼────────┼────────┼────────┼──────────┤
│ 山田   │ 75%    │ 70%    │ 68%    │ 72%    │ 72%      │
│ 佐藤   │ 60%    │ 65%    │ 70%    │ 62%    │ 65%      │
│ 高橋   │ 80%    │ 75%    │ 78%    │ 80%    │ 78%      │
└────────┴────────┴────────┴────────┴────────┴──────────┘

┌─────────────────────────────────────────────────────────┐
│       [レーダーチャート - 3人のスコアを重ね表示]        │
│              GOV                                        │
│               ▲                                         │
│              /|\                                        │
│             / | \                                       │
│    WORK ──/  |  \── CONFLICT                           │
│            \ | /                                        │
│             \|/                                         │
│      REL ───┴─── COG                                   │
│       ── 山田  ── 佐藤  ── 高橋                        │
└─────────────────────────────────────────────────────────┘
```

## 8.6 面接ポイント表示

### 生成ロジック

```typescript
interface InterviewPoint {
  type: 'strength' | 'confirm';
  domain: string;
  point: string;
  suggestedQuestion?: string;
}

function generateInterviewPoints(scores: DomainScores): InterviewPoint[] {
  const points: InterviewPoint[] = [];

  // 強み（80%以上のドメイン）
  Object.entries(scores).forEach(([domain, score]) => {
    if (domain !== 'VALID' && score >= 80) {
      points.push({
        type: 'strength',
        domain,
        point: STRENGTH_TEMPLATES[domain],
      });
    }
  });

  // 確認点（60%以下のドメイン）
  Object.entries(scores).forEach(([domain, score]) => {
    if (domain !== 'VALID' && domain !== 'COG' && score <= 60) {
      points.push({
        type: 'confirm',
        domain,
        point: CONFIRM_TEMPLATES[domain],
        suggestedQuestion: QUESTION_TEMPLATES[domain],
      });
    }
  });

  // COG特別処理（高いほど注意）
  if (scores.COG > 50) {
    points.push({
      type: 'confirm',
      domain: 'COG',
      point: '被害者意識や感情的反応の傾向が見られます',
      suggestedQuestion: '過去に理不尽だと感じた出来事と、その時どう対処したか教えてください',
    });
  }

  return points;
}
```

### 表示UI（候補者詳細ページ内）

```
┌─────────────────────────────────────────────────────────┐
│ 📝 面接確認ポイント                                     │
├─────────────────────────────────────────────────────────┤
│ ✅ 強み                                                 │
│ ・ガバナンス意識が高く、ルール遵守の姿勢が強い         │
│ ・業務遂行能力が高く、計画的に仕事を進められる         │
├─────────────────────────────────────────────────────────┤
│ ❓ 確認すべき点                                         │
│ ・対立場面での対応経験を確認（CONFLICTスコア低め）     │
│   → 「チームで意見が対立した時、どう対処しますか？」   │
│                                                         │
│ ・フィードバック受容性を確認（RELスコア低め）          │
│   → 「厳しいフィードバックを受けた経験を教えて」       │
└─────────────────────────────────────────────────────────┘
```

---

# 9. フロントエンドデザイン改善詳細

## 9.1 全体的なデザイン改善

### カラーパレット統一

```css
/* 判定カラー */
--color-recommended: #10b981; /* 緑 - 推奨 */
--color-consider: #f59e0b;    /* 黄 - 要検討 */
--color-caution: #ef4444;     /* 赤 - 慎重 */

/* ドメインカラー */
--color-gov: #3b82f6;      /* 青 */
--color-conflict: #8b5cf6; /* 紫 */
--color-rel: #ec4899;      /* ピンク */
--color-cog: #f97316;      /* オレンジ */
--color-work: #14b8a6;     /* ティール */
--color-valid: #6b7280;    /* グレー */
```

### アイコン統一

| 用途 | アイコン | 色 |
|-----|---------|---|
| 推奨 | ⭐ Star | 緑 |
| 要検討 | 🔍 Search | 黄 |
| 慎重 | ⚠️ AlertTriangle | 赤 |
| 期限警告 | ⏰ Clock | オレンジ |
| 分析待ち | 📊 BarChart | 青 |
| 高評価 | 🏆 Trophy | 金 |

## 9.2 コンポーネント別改善

### StatCard改善

**現状**:
- シンプルなカード
- アイコンが小さい

**改善案**:
- 背景グラデーション追加
- アイコンを大きく
- トレンド矢印追加

```tsx
// 改善後のStatCard
<Card className="bg-gradient-to-br from-blue-50 to-white border-blue-100">
  <CardHeader className="flex flex-row items-center justify-between pb-2">
    <CardTitle className="text-sm font-medium text-blue-600">{title}</CardTitle>
    <div className="p-2 bg-blue-100 rounded-lg">
      <Icon className="h-5 w-5 text-blue-600" />
    </div>
  </CardHeader>
  <CardContent>
    <div className="text-3xl font-bold">{value}</div>
    <div className="flex items-center gap-1 text-xs text-muted-foreground">
      <TrendingUp className="h-3 w-3 text-green-500" />
      <span>+12% from last week</span>
    </div>
  </CardContent>
</Card>
```

### テーブル改善

**現状**:
- プレーンなテーブル
- 情報が均一

**改善案**:
- 重要カラムをハイライト
- ホバーエフェクト
- ステータスバッジを色分け

### チャート改善

**現状**:
- 基本的なRecharts
- インタラクティブ性なし

**改善案**:
- ツールチップ充実
- クリックで詳細表示
- アニメーション追加

## 9.3 レスポンシブ対応

### ブレークポイント

| サイズ | 幅 | レイアウト |
|-------|---|-----------|
| sm | < 640px | 1カラム、サイドバー非表示 |
| md | 640-1024px | 2カラム、サイドバー折りたたみ |
| lg | > 1024px | 4カラム、サイドバー展開 |

### モバイル最適化

- 統計カードを縦並び
- チャートをスワイプ可能に
- テーブルを横スクロール or カード表示

---

# 10. 実装優先順位まとめ

## 最優先（ビジネスインパクト大）

| 機能 | 理由 | 工数 |
|-----|------|-----|
| アクション必要セクション | 即座に行動を促せる | 2-3h |
| 判定ラベル自動付与 | 採用判断の効率化 | 2-3h |
| 注目候補者セクション | 重要候補者の見逃し防止 | 2-3h |

## 高優先（ユーザー価値高）

| 機能 | 理由 | 工数 |
|-----|------|-----|
| 候補者比較ページ | 客観的比較を実現 | 4-5h |
| 面接ポイント表示 | 検査結果の活用促進 | 3-4h |
| パイプラインファネル | 全体把握の改善 | 2-3h |

## 中優先（UX改善）

| 機能 | 理由 | 工数 |
|-----|------|-----|
| デザイン統一 | 視覚的品質向上 | 3-4h |
| レスポンシブ改善 | モバイル対応 | 2-3h |
| スケルトンUI | 体感速度向上 | 1-2h |

---

# 11. 候補者管理画面 完全設計

## 11.1 ビジネスゴールからの逆算

### 採用担当者の本質的ニーズ

| ニーズ | 現状の問題 | あるべき姿 |
|-------|----------|-----------|
| **「この候補者どう？」への即答** | 詳細ページに入らないと判定がわからない | 一覧でスコア・判定バッジが見える |
| **「次に何すべき？」の明確化** | アクション導線が弱い | クイックアクションが充実 |
| **「誰を優先？」への回答** | ソート・フィルターがない | 多彩なフィルター・ソート |
| **「比較したい」への対応** | 1人ずつ確認するしかない | 一覧から比較ページへ送れる |
| **「面接で何聞く？」の準備** | 別ページを見る必要あり | 詳細ページで面接ポイント表示 |

### 現状の問題点分析

#### 一覧ページ (`/admin/candidates`)

| 問題 | 影響 | 優先度 |
|-----|------|-------|
| 検索・フィルターなし | 大量候補者から探せない | 🔴 高 |
| スコア/判定が非表示 | 一目で優先度がわからない | 🔴 高 |
| クイックアクション不足 | 「詳細」のみで効率悪い | 🟡 中 |
| バルクアクションなし | 一括操作不可 | 🟡 中 |
| ソート機能なし | 日付・スコア順に並べ替え不可 | 🟡 中 |
| ページネーションなし | 大量データで重くなる | 🟡 中 |

#### 詳細ページ (`/admin/candidates/[id]`)

| 問題 | 影響 | 優先度 |
|-----|------|-------|
| 分析結果が見えない | 検査詳細に遷移必要 | 🔴 高 |
| 判定バッジなし | 推奨/要検討/慎重がわからない | 🔴 高 |
| 面接ポイントなし | 面接準備ができない | 🔴 高 |
| 編集機能なし | 備考等の更新不可 | 🟡 中 |
| タイムラインなし | イベント履歴不明 | 🟢 低 |

#### 新規登録ページ (`/admin/candidates/new`)

| 問題 | 影響 | 優先度 |
|-----|------|-------|
| 検査同時発行オプションなし | 登録後に別途発行が必要 | 🟡 中 |
| テンプレート選択なし | デフォルトのみ | 🟢 低 |

## 11.2 画面設計 - 一覧ページ

### 完成状態イメージ

```
┌─────────────────────────────────────────────────────────────────────┐
│ 候補者管理                                          [+ 候補者を追加]│
├─────────────────────────────────────────────────────────────────────┤
│ フィルター・検索バー                                                │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ [🔍 名前/メールで検索      ] [職種▼] [ステータス▼] [判定▼]     │ │
│ │ 表示: 25件 / 全123件  ソート: [登録日が新しい順▼]              │ │
│ └─────────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────┤
│ バルクアクションバー                                                │
│ ☐ 全選択   選択中: 3件   [一括検査発行] [比較に追加] [CSVエクスポート]│
├─────────────────────────────────────────────────────────────────────┤
│ 候補者カード（テーブルではなくカード形式で情報密度向上）            │
│                                                                     │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ ☐ 田中太郎                                          ⭐推奨     │ │
│ │   📧 tanaka@example.com | 💼 営業職                             │ │
│ │   ┌──────────────────────────────────┐                          │ │
│ │   │ 総合 85% ████████████░░ [ミニレーダー]                      │ │
│ │   └──────────────────────────────────┘                          │ │
│ │   ✅ 検査完了 (12/22)                   [詳細] [比較] [PDF]     │ │
│ └─────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ ☐ 山田一郎                                          🔍要検討   │ │
│ │   📧 yamada@example.com | 💼 エンジニア                         │ │
│ │   ┌──────────────────────────────────┐                          │ │
│ │   │ 総合 68% ████████░░░░░                                      │ │
│ │   └──────────────────────────────────┘                          │ │
│ │   🔵 回答中 (残り3日)                   [詳細] [リマインド]     │ │
│ └─────────────────────────────────────────────────────────────────┘ │
│                                                                     │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ ☐ 佐藤花子                                           未検査    │ │
│ │   📧 sato@example.com | 💼 マーケ                               │ │
│ │   ░░░░░░░░░░░░░░░░ スコアなし                                   │ │
│ │   ⚪ 検査未発行                         [詳細] [検査を発行]     │ │
│ └─────────────────────────────────────────────────────────────────┘ │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│ ページネーション                                                    │
│ ← 前   1  [2]  3  4  ...  10   次 →                                │
└─────────────────────────────────────────────────────────────────────┘
```

### 表示すべき項目

| 項目 | 必須 | 表示場所 | 備考 |
|-----|------|---------|------|
| 氏名 | ✅ | カードタイトル | クリックで詳細へ |
| メール | ✅ | カード内 | アイコン付き |
| 職種 | ✅ | カード内 | バッジ形式 |
| 総合スコア | ✅ | カード内 | プログレスバー + 数値 |
| 判定バッジ | ✅ | カード右上 | 推奨/要検討/慎重 |
| ステータス | ✅ | カード下部 | アイコン + テキスト |
| 登録日 | ○ | カード内（省略可） | |
| ミニレーダー | ○ | カード内（オプション） | 5ドメイン簡易表示 |

### フィルター・ソート機能

| 機能 | 種類 | 選択肢 |
|-----|------|-------|
| 検索 | テキスト | 名前・メールで部分一致 |
| 職種 | セレクト | 全て / 各職種 |
| ステータス | セレクト | 全て / 未検査 / 回答中 / 完了 / 分析済み |
| 判定 | セレクト | 全て / 推奨 / 要検討 / 慎重 / 未分析 |
| ソート | セレクト | 登録日 / スコア / 名前順 |

## 11.3 画面設計 - 詳細ページ

### 完成状態イメージ

```
┌─────────────────────────────────────────────────────────────────────┐
│ ← 候補者一覧に戻る                                                  │
├─────────────────────────────────────────────────────────────────────┤
│ ヘッダー                                                            │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ 田中太郎                                            ⭐推奨      │ │
│ │ 📧 tanaka@example.com | 💼 営業職                               │ │
│ │                                                                 │ │
│ │ [検査を発行] [編集] [比較に追加] [PDF出力] [···削除]            │ │
│ └─────────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────┤
│ 2カラムレイアウト                                                   │
│ ┌─────────────────────────┬─────────────────────────────────────┐   │
│ │ 基本情報カード          │ 最新分析結果カード                  │   │
│ │ ───────────────────     │ ───────────────────────────────     │   │
│ │ 📧 tanaka@example.com   │         総合スコア                  │   │
│ │ 📅 登録: 2024/12/20     │    ┌────────────┐                   │   │
│ │                         │    │   85%      │  ⭐推奨           │   │
│ │ 💼 希望職種             │    └────────────┘                   │   │
│ │  ┌───────┐ ┌───────┐    │                                     │   │
│ │  │営業職 │ │企画職 │    │  ┌─────────────────────────────┐   │   │
│ │  └───────┘ └───────┘    │  │    [レーダーチャート]        │   │   │
│ │                         │  └─────────────────────────────┘   │   │
│ │ 📝 備考                 │                                     │   │
│ │ 前職: XX社営業3年       │  GOV: 88%  CONFLICT: 75%            │   │
│ │ 紹介者: 山本課長        │  REL: 82%  WORK: 85%                │   │
│ │           [編集]        │  COG: 35%  VALID: 78%               │   │
│ │                         │                                     │   │
│ │                         │  [詳細分析を見る →]                 │   │
│ └─────────────────────────┴─────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────────┤
│ 面接確認ポイントカード                                              │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ 📝 面接確認ポイント                                             │ │
│ │ ─────────────────────────────────────────────────────────────── │ │
│ │ ✅ 強み                                                         │ │
│ │ ┌───────────────────────────────────────────────────────────┐   │ │
│ │ │ [GOV] ガバナンス意識が高く、ルール遵守の姿勢が強い        │   │ │
│ │ └───────────────────────────────────────────────────────────┘   │ │
│ │ ┌───────────────────────────────────────────────────────────┐   │ │
│ │ │ [WORK] 業務遂行能力が高く、計画的に仕事を進められる       │   │ │
│ │ └───────────────────────────────────────────────────────────┘   │ │
│ │                                                                 │ │
│ │ ❓ 確認すべき点                                                  │ │
│ │ ┌───────────────────────────────────────────────────────────┐   │ │
│ │ │ [CONFLICT] 対立場面での対応経験を確認                     │   │ │
│ │ │ 💬 「チームで意見が対立した時、どう解決しますか？」       │   │ │
│ │ └───────────────────────────────────────────────────────────┘   │ │
│ └─────────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────┤
│ 検査セクション（現在のまま維持 + 改善）                             │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ 📋 検査                                                         │ │
│ │ ─────────────────────────────────────────────────────────────── │ │
│ │ 最新の検査:                                                     │ │
│ │ ✅ GFD-Gate v1.0  完了 (2024/12/22 14:30)       [結果を見る]    │ │
│ │                                                                 │ │
│ │ URL: https://xxx.vercel.app/assessment/abc123                   │ │
│ │ [コピー]                                                        │ │
│ │                                                                 │ │
│ │ 検査履歴:                                                       │ │
│ │ ├─ 2024/12/22 ✅完了 GFD-Gate v1.0                             │ │
│ │ └─ 2024/12/15 ⏰期限切れ GFD-Gate v1.0                         │ │
│ └─────────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────────┤
│ タイムライン（オプション・将来実装）                                │
│ ┌─────────────────────────────────────────────────────────────────┐ │
│ │ 📅 タイムライン                                                 │ │
│ │ ─────────────────────────────────────────────────────────────── │ │
│ │ ● 12/22 14:35  AI分析完了                                       │ │
│ │ ● 12/22 14:30  検査完了                                         │ │
│ │ ● 12/20 10:00  検査URL発行                                      │ │
│ │ ○ 12/20 09:30  候補者登録                                       │ │
│ └─────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────┘
```

### 表示すべきセクション

| セクション | 必須 | 内容 | 優先度 |
|----------|------|------|-------|
| ヘッダー | ✅ | 名前、判定バッジ、アクションボタン | 🔴 高 |
| 基本情報 | ✅ | メール、登録日、職種、備考 | 🔴 高 |
| 最新分析結果 | ✅ | スコア、レーダー、詳細リンク | 🔴 高 |
| 面接ポイント | ✅ | 強み、確認点、質問例 | 🔴 高 |
| 検査セクション | ✅ | URL表示、ステータス、履歴 | 既存改善 |
| タイムライン | ○ | イベント履歴 | 🟢 低（将来） |

## 11.4 画面遷移設計

```
/admin/candidates (一覧)
├── [+ 候補者を追加] → /admin/candidates/new
├── [候補者カードクリック] → /admin/candidates/[id]
├── [比較ボタン] → /admin/compare?ids=xxx,yyy,zzz
├── [検査を発行] → モーダル → リロード
├── [フィルター変更] → URLクエリパラメータ更新
└── [ページネーション] → URLクエリパラメータ更新

/admin/candidates/[id] (詳細)
├── [← 一覧に戻る] → /admin/candidates
├── [検査を発行] → モーダル → リロード
├── [編集] → インラインモーダル → リロード
├── [比較に追加] → ローカルストレージ保存 → トースト通知
├── [PDF出力] → ダウンロード
├── [削除] → 確認モーダル → /admin/candidates
├── [詳細分析を見る] → /admin/assessments/[assessmentId]
└── [結果を見る] → /admin/assessments/[assessmentId]

/admin/candidates/new (新規登録)
├── [キャンセル] → /admin/candidates
└── [登録する] → /admin/candidates/[新ID]
```

## 11.5 実装計画

### Phase 1: 一覧ページ強化（優先度：高）

| タスク | 内容 | 工数 |
|-------|------|-----|
| CandidateCard作成 | スコア・判定付きカードコンポーネント | 2h |
| フィルターバー作成 | 検索・職種・ステータス・判定フィルター | 2h |
| ソート機能 | 日付・スコア・名前ソート | 1h |
| バルクアクション | チェックボックス・一括操作 | 2h |
| ページネーション | Supabase range()活用 | 1h |
| URLクエリ連携 | フィルター状態をURL保持 | 1h |

### Phase 2: 詳細ページ強化（優先度：高）

| タスク | 内容 | 工数 |
|-------|------|-----|
| ヘッダー改善 | 判定バッジ・アクションボタン追加 | 1h |
| 分析結果カード | スコア表示・ミニレーダー | 2h |
| 面接ポイント統合 | InterviewPointsコンポーネント活用 | 1h |
| 編集モーダル | 備考編集機能 | 2h |
| 比較に追加機能 | ローカルストレージ保存 | 1h |

### Phase 3: 新規登録改善（優先度：中）

| タスク | 内容 | 工数 |
|-------|------|-----|
| 検査同時発行オプション | チェックボックス追加 | 1h |
| テンプレート選択 | セレクトボックス追加 | 1h |

## 11.6 コンポーネント設計

### CandidateCard

```typescript
interface CandidateCardProps {
  candidate: {
    id: string;
    name: string;
    email: string;
    position: string;
    status: 'no_assessment' | 'pending' | 'in_progress' | 'completed' | 'analyzed';
    overallScore?: number;
    judgment?: 'recommended' | 'consider' | 'caution';
    expiresAt?: string;
    completedAt?: string;
  };
  isSelected: boolean;
  onSelect: (id: string, checked: boolean) => void;
  onIssueAssessment?: () => void;
}
```

### CandidateFilters

```typescript
interface CandidateFiltersProps {
  filters: {
    search: string;
    position: string;
    status: string;
    judgment: string;
    sortBy: 'created_at' | 'score' | 'name';
    sortOrder: 'asc' | 'desc';
  };
  onFilterChange: (filters: Partial<CandidateFiltersProps['filters']>) => void;
  positions: { value: string; label: string }[];
  totalCount: number;
  displayCount: number;
}
```

### CandidateAnalysisSummary

```typescript
interface CandidateAnalysisSummaryProps {
  scores: Record<string, number>;
  judgment: {
    level: 'recommended' | 'consider' | 'caution';
    label: string;
    reasons: string[];
  };
  assessmentId: string;
}
```

---

**作成者**: Claude Code
**レビュー**: 未
